import{S as m}from"./gsap.BHYimGvR.js";import{f as d}from"./utils.CdJYMqT6.js";import"./index.D3jsOSc0.js";const n=8,r=document.getElementById("total-transactions");let o=!1;const t={fetchTransactions:null,scheduleNext:null,blocksFetch:null,initialLoad:null};window.lastFetchTimestamp=0;const l=new CustomEvent("fetchTransactions"),u=new CustomEvent("fetchBlocks");function s(){Object.values(t).forEach(e=>{e&&clearTimeout(e)}),t.fetchTransactions=null,t.scheduleNext=null,t.blocksFetch=null,t.initialLoad=null}async function h(){try{const e=await fetch("/api/total-transactions");if(!e.ok)throw new Error(`${e.status}, ${e.statusText}`);const{data:c}=await e.json();r&&(r.textContent=d(c.value||0))}catch(e){console.error("Error updating block data:",e)}}async function a(){try{if(!o)return;await h(),t.fetchTransactions&&clearTimeout(t.fetchTransactions),o&&(t.fetchTransactions=setTimeout(a,n*1e3))}catch(e){console.error("Error updating block data:",e),t.fetchTransactions&&clearTimeout(t.fetchTransactions),o&&(t.fetchTransactions=setTimeout(a,n*2*1e3))}}function i(){o&&(window.lastFetchTimestamp=Date.now(),window.dispatchEvent(l),t.blocksFetch&&clearTimeout(t.blocksFetch),t.blocksFetch=setTimeout(()=>{o&&window.dispatchEvent(u)},4e3),t.scheduleNext&&clearTimeout(t.scheduleNext),o&&(t.scheduleNext=setTimeout(i,n*1e3)))}window.dispatchEvent(l);window.dispatchEvent(u);h();m.create({trigger:"#numbers",start:"top bottom",end:"bottom top",onEnter:()=>{s(),o=!0,t.initialLoad=setTimeout(()=>{a(),i()},1500)},onLeave:()=>{o=!1,s()},onEnterBack:()=>{s(),o=!0,a();const c=(Date.now()-window.lastFetchTimestamp)%(n*1e3),f=c>0?n*1e3-c:0;t.scheduleNext&&clearTimeout(t.scheduleNext),t.scheduleNext=setTimeout(i,f)},onLeaveBack:()=>{o=!1,s()}});
