import{a as y}from"./_astro_actions.B1Hs8mhV.js";import{e as S}from"./recaptcha.D_J8fXFO.js";const t=document.getElementById("snow-report-newsletter-form"),h=t?.querySelectorAll("input[required], textarea[required], select[required]"),n=t.querySelector("#form-steps-wrapper"),k=t.querySelector("#form-steps-next"),q=t.querySelector("#form-steps-back"),o=t.querySelector("#step-counter"),p=t.querySelector("#total-steps");let e=0,l=!1;const a=n?.children.length;p&&(p.textContent=String(a));t?.style.setProperty("--total-steps",String(a));t?.style.setProperty("--step",String(e+1));k?.addEventListener("click",async()=>{if(!(!n||!a||!t||!o)){if(l){e=0,u(),l=!1;return}if(e===0){const r=n.children[e],s=r.querySelector('input[name="firstname"]'),c=r.querySelector('input[name="email"]'),i=r.querySelector('select[name="country"]');if(s.checkValidity()||s.classList.add("invalid"),c.checkValidity()||c.classList.add("invalid"),i.checkValidity()||i.classList.add("invalid"),!s.checkValidity()||!c.checkValidity()||!i.checkValidity())return;d();return}if(e===1){const s=n.children[e].querySelector('input[name="company"]');if(!s.checkValidity()){s.classList.add("invalid");return}t.classList.add("submit"),d();return}if(e===2){const r=n.children[e],s=r.querySelector('input[name="gdpr"]'),c=r.querySelector('input[name="marketing_consent"]');if(s.checkValidity()||s.classList.add("invalid"),c.checkValidity()||c.classList.add("invalid"),!s.checkValidity()||!c.checkValidity())return;const i=new FormData(t),m=await S();i.append("recaptchaToken",m);const{data:f}=await y.forms.snow_report_newsletter(i);f?.success?(t.classList.remove("submit"),t.classList.add("done")):(t.classList.remove("submit"),t.classList.add("error"),l=!0),d();return}}});const d=()=>{!n||!a||!t||!o||(e++,e<a&&u())},v=()=>{!n||!a||!t||!o||(e--,e>=0&&u())};q?.addEventListener("click",()=>{v()});const u=()=>{n.style.transform=`translateX(calc((-100% - var(--gap-2xl)) * ${e}))`,t.style.setProperty("--step",String(e+1)),o.textContent=String(e+1)};h.forEach(r=>{r.addEventListener("input",()=>{r.checkValidity()&&r.classList.remove("invalid")})});
